<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc -->
<title>SOCDBHelper (JSettlers 3.0.3 API)</title>
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="SOCDBHelper (JSettlers 3.0.3 API)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10,"i5":9,"i6":10,"i7":10,"i8":10,"i9":10,"i10":10,"i11":10,"i12":10,"i13":10,"i14":10,"i15":10,"i16":10,"i17":10,"i18":10,"i19":10,"i20":10,"i21":10,"i22":10,"i23":10,"i24":10,"i25":10,"i26":10,"i27":10,"i28":10};
var tabs = {65535:["t0","All Methods"],1:["t1","Static Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../soc/server/database/DBSettingMismatchException.html" title="class in soc.server.database"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../soc/server/database/SOCDBHelper.AuthPasswordRunnable.html" title="interface in soc.server.database"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?soc/server/database/SOCDBHelper.html" target="_top">Frames</a></li>
<li><a href="SOCDBHelper.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">soc.server.database</div>
<h2 title="Class SOCDBHelper" class="title">Class SOCDBHelper</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>soc.server.database.SOCDBHelper</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="typeNameLabel">SOCDBHelper</span>
extends java.lang.Object</pre>
<div class="block">This class contains methods for connecting to a database
 and for manipulating the data stored there.
 See <code>/Readme.md</code> for more info on how JSettlers uses this optional database,
 and <code>/doc/Readme.developer.md</code> for developing and testing with it.
<P>
 Originally based on jdbc code found at www.javaworld.com
<P>
 This code assumes that you're using mySQL as your database,
 but allows you to use other database types.
 The default URL is "jdbc:mysql://localhost/socdata".
 The default driver is "com.mysql.jdbc.Driver".
 These can be changed by supplying properties to <a href="../../../soc/server/database/SOCDBHelper.html#initialize-java.lang.String-java.lang.String-java.util.Properties-"><code>initialize(String, String, Properties)</code></a>
 for <a href="../../../soc/server/database/SOCDBHelper.html#PROP_JSETTLERS_DB_URL"><code>PROP_JSETTLERS_DB_URL</code></a> and <a href="../../../soc/server/database/SOCDBHelper.html#PROP_JSETTLERS_DB_DRIVER"><code>PROP_JSETTLERS_DB_DRIVER</code></a>.
<P>
 For database schema, see <code>src/main/bin/sql/template/jsettlers-tables-tmpl.sql</code>.

<H3>Schema Upgrades:</H3>
 Sometimes a new JSettlers version adds to the DB schema. When starting the JSettlers server, call
 <a href="../../../soc/server/database/SOCDBHelper.html#isSchemaLatestVersion--"><code>isSchemaLatestVersion()</code></a> to check, and if needed <a href="../../../soc/server/database/SOCDBHelper.html#upgradeSchema-java.util.Set-"><code>upgradeSchema(Set)</code></a>.
 To improve flexibility, currently we let the server's admin defer upgrades and continue running
 with the old schema until they have time to upgrade it.
<P>
 After an upgrade, further background tasks such as data conversions may be needed.
 These can run while the server is operating normally (running games, bots, and channels).
 See <a href="../../../soc/server/database/SOCDBHelper.html#doesSchemaUpgradeNeedBGTasks--"><code>doesSchemaUpgradeNeedBGTasks()</code></a>.

<H3>Testing:</H3>
 For unit tests, call <a href="../../../soc/server/database/SOCDBHelper.html#testDBHelper--"><code>testDBHelper()</code></a> on a temporary copy of a database.

<H3>Threads:</H3>
 Remember that some JDBC drivers may not cleanly handle multi-threaded access
 (some versions of the SQLite driver, for example). Use <a href="../../../soc/server/SOCServer.html" title="class in soc.server"><code>SOCServer</code></a>'s
 Treater thread when accessing the DB, especially for updates or inserts.

<H3>Settings:</H3>
 When using <a href="../../../soc/server/database/SOCDBHelper.html#SCHEMA_VERSION_1200"><code>SCHEMA_VERSION_1200</code></a> and above, the DB has a <code>settings</code> table to
 store things like <a href="../../../soc/server/database/SOCDBHelper.html#SETTING_BCRYPT_WORK__FACTOR"><code>SETTING_BCRYPT_WORK__FACTOR</code></a>. See <a href="../../../soc/server/database/SOCDBHelper.html#checkSettings-boolean-boolean-"><code>checkSettings(boolean, boolean)</code></a>,
 <a href="../../../soc/server/database/SOCDBHelper.html#getSettingsFormatted-soc.server.SOCServer-"><code>getSettingsFormatted(SOCServer)</code></a>, and <a href="../../../soc/server/database/SOCDBHelper.html#PROP_JSETTLERS_DB_SETTINGS"><code>PROP_JSETTLERS_DB_SETTINGS</code></a>.

<H3>Password Hashing:</H3>
 When using <a href="../../../soc/server/database/SOCDBHelper.html#SCHEMA_VERSION_1200"><code>SCHEMA_VERSION_1200</code></a> and above, user account passwords are hashed
 with <a href="../../../soc/server/database/BCrypt.html" title="class in soc.server.database"><code>BCrypt</code></a>. See <a href="../../../soc/server/database/SOCDBHelper.html#PW_SCHEME_BCRYPT"><code>PW_SCHEME_BCRYPT</code></a> for more details.
 Password hashing details are encapsulated here: SOCServer itself only needs to optionally
 determine a Work Factor once, pass it to <a href="../../../soc/server/database/SOCDBHelper.html#initialize-java.lang.String-java.lang.String-java.util.Properties-"><code>initialize(String, String, Properties)</code></a>
 using <a href="../../../soc/server/database/SOCDBHelper.html#PROP_JSETTLERS_DB_BCRYPT_WORK__FACTOR"><code>PROP_JSETTLERS_DB_BCRYPT_WORK__FACTOR</code></a>, and save it to the settings table
 using <a href="../../../soc/server/database/SOCDBHelper.html#checkSettings-boolean-boolean-"><code>checkSettings(true, true)</code></a>.

<H3>Transactions:</H3>
 Some database types and drivers may use an "auto-commit" mode by default, others might not, for individual
 SQL commands. To account for this when a longer transaction is needed, and abstract it a bit,
 call methods <a href="../../../soc/server/database/SOCDBHelper.html#enterTransactionMode--"><code>enterTransactionMode()</code></a> and <a href="../../../soc/server/database/SOCDBHelper.html#exitTransactionMode-boolean-"><code>exitTransactionMode(boolean)</code></a> around your
 transaction's SQL commands. See those methods' javadocs for details.

<H3>Class history:</H3>
 Before v2.4.50, <code>SOCDBHelper</code> methods were static. That version changed to non-static
 so any third-party developers could extend or change DB functionality.</div>
<dl>
<dt><span class="simpleTagLabel">Author:</span></dt>
<dd>Robert S. Thomas</dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="nested.class.summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Nested Class Summary table, listing nested classes, and an explanation">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Class and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static interface&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../soc/server/database/SOCDBHelper.AuthPasswordRunnable.html" title="interface in soc.server.database">SOCDBHelper.AuthPasswordRunnable</a></span></code>
<div class="block">Interface for callbacks from <a href="../../../soc/server/database/SOCDBHelper.html#authenticateUserPassword-java.lang.String-java.lang.String-soc.server.database.SOCDBHelper.AuthPasswordRunnable-"><code>authenticateUserPassword(String, String, AuthPasswordRunnable)</code></a>.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../soc/server/database/SOCDBHelper.html#BCRYPT_DEFAULT_WORK_FACTOR">BCRYPT_DEFAULT_WORK_FACTOR</a></span></code>
<div class="block">Default Work Factor (12) for <a href="../../../soc/server/database/SOCDBHelper.html#PW_SCHEME_BCRYPT"><code>PW_SCHEME_BCRYPT</code></a> encoding in JSettlers:
 Password hashing round count's power of 2, see <a href="../../../soc/server/database/BCrypt.html#gensalt-int-"><code>BCrypt.gensalt(int)</code></a> for details.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../soc/server/database/SOCDBHelper.html#BCRYPT_MIN_WORK_FACTOR">BCRYPT_MIN_WORK_FACTOR</a></span></code>
<div class="block">Minimum Work Factor (9) allowed for <a href="../../../soc/server/database/SOCDBHelper.html#PW_SCHEME_BCRYPT"><code>PW_SCHEME_BCRYPT</code></a> encoding in JSettlers:
 see <a href="../../../soc/server/database/SOCDBHelper.html#BCRYPT_DEFAULT_WORK_FACTOR"><code>BCRYPT_DEFAULT_WORK_FACTOR</code></a> for details.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../soc/server/database/SOCDBHelper.html#PROP_IMPL_JSETTLERS_PW_RESET">PROP_IMPL_JSETTLERS_PW_RESET</a></span></code>
<div class="block">Internal property name used to hold the <tt>--pw-reset</tt> command line argument's username.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../soc/server/database/SOCDBHelper.html#PROP_JSETTLERS_DB_BCRYPT_WORK__FACTOR">PROP_JSETTLERS_DB_BCRYPT_WORK__FACTOR</a></span></code>
<div class="block">Integer property <tt>jsettlers.db.bcrypt.work_factor</tt> to set or test the <a href="../../../soc/server/database/BCrypt.html" title="class in soc.server.database"><code>BCrypt</code></a> work factor
 (password hashing round count's power of 2, see <a href="../../../soc/server/database/BCrypt.html#gensalt-int-"><code>BCrypt.gensalt(int)</code></a> for details).</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../soc/server/database/SOCDBHelper.html#PROP_JSETTLERS_DB_DRIVER">PROP_JSETTLERS_DB_DRIVER</a></span></code>
<div class="block">Property <tt>jsettlers.db.driver</tt> to specify the server's JDBC driver class.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../soc/server/database/SOCDBHelper.html#PROP_JSETTLERS_DB_JAR">PROP_JSETTLERS_DB_JAR</a></span></code>
<div class="block">Property <tt>jsettlers.db.jar</tt> to specify the JAR filename for the server's JDBC driver.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../soc/server/database/SOCDBHelper.html#PROP_JSETTLERS_DB_PASS">PROP_JSETTLERS_DB_PASS</a></span></code>
<div class="block">Property <tt>jsettlers.db.pass</tt> to specify the server's SQL database password.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../soc/server/database/SOCDBHelper.html#PROP_JSETTLERS_DB_SAVE_GAMES">PROP_JSETTLERS_DB_SAVE_GAMES</a></span></code>
<div class="block">Property <tt>jsettlers.db.save.games</tt> to ask to save
 all game results and scores in the database.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../soc/server/database/SOCDBHelper.html#PROP_JSETTLERS_DB_SCRIPT_SETUP">PROP_JSETTLERS_DB_SCRIPT_SETUP</a></span></code>
<div class="block">Property <tt>jsettlers.db.script.setup</tt> to run a SQL setup script
 at server startup, then exit.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../soc/server/database/SOCDBHelper.html#PROP_JSETTLERS_DB_SETTINGS">PROP_JSETTLERS_DB_SETTINGS</a></span></code>
<div class="block">Utility property <tt>jsettlers.db.settings</tt> to write the values of settings properties
 like <a href="../../../soc/server/database/SOCDBHelper.html#PROP_JSETTLERS_DB_BCRYPT_WORK__FACTOR"><code>PROP_JSETTLERS_DB_BCRYPT_WORK__FACTOR</code></a> to the <code>settings</code> table.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../soc/server/database/SOCDBHelper.html#PROP_JSETTLERS_DB_UPGRADE__SCHEMA">PROP_JSETTLERS_DB_UPGRADE__SCHEMA</a></span></code>
<div class="block">Boolean property <code>jsettlers.db.upgrade_schema</code> to run <a href="../../../soc/server/database/SOCDBHelper.html#upgradeSchema-java.util.Set-"><code>upgradeSchema(Set)</code></a>
 at server startup, then exit.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../soc/server/database/SOCDBHelper.html#PROP_JSETTLERS_DB_URL">PROP_JSETTLERS_DB_URL</a></span></code>
<div class="block">Property <tt>jsettlers.db.url</tt> to specify the server's URL.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../soc/server/database/SOCDBHelper.html#PROP_JSETTLERS_DB_USER">PROP_JSETTLERS_DB_USER</a></span></code>
<div class="block">Property <tt>jsettlers.db.user</tt> to specify the server's SQL database username.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../soc/server/database/SOCDBHelper.html#PROP_SQLITE_TMPDIR">PROP_SQLITE_TMPDIR</a></span></code>
<div class="block">For convenience/reference, the JVM property name that xerial sqlite-jdbc uses
 when extracting its native library to a non-default temp directory.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../soc/server/database/SOCDBHelper.html#PW_MAX_LEN_SCHEME_BCRYPT">PW_MAX_LEN_SCHEME_BCRYPT</a></span></code>
<div class="block">Max length for a JSettlers account password when using <a href="../../../soc/server/database/SOCDBHelper.html#PW_SCHEME_BCRYPT"><code>PW_SCHEME_BCRYPT</code></a>.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../soc/server/database/SOCDBHelper.html#PW_MAX_LEN_SCHEME_NONE">PW_MAX_LEN_SCHEME_NONE</a></span></code>
<div class="block">Original max length for a JSettlers account password when using <a href="../../../soc/server/database/SOCDBHelper.html#PW_SCHEME_NONE"><code>PW_SCHEME_NONE</code></a>.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../soc/server/database/SOCDBHelper.html#PW_SCHEME_BCRYPT">PW_SCHEME_BCRYPT</a></span></code>
<div class="block">Password encoding scheme #1: <a href="../../../soc/server/database/BCrypt.html" title="class in soc.server.database"><code>BCrypt</code></a>.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../soc/server/database/SOCDBHelper.html#PW_SCHEME_NONE">PW_SCHEME_NONE</a></span></code>
<div class="block">No password encoding scheme: plain text.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../soc/server/database/SOCDBHelper.html#SCHEMA_VERSION_1200">SCHEMA_VERSION_1200</a></span></code>
<div class="block">First updated JSettlers schema version (1.2.00) which adds any new extra tables/fields.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../soc/server/database/SOCDBHelper.html#SCHEMA_VERSION_2000">SCHEMA_VERSION_2000</a></span></code>
<div class="block">JSettlers schema version 2.0.00, with extra tables/fields added since <a href="../../../soc/server/database/SOCDBHelper.html#SCHEMA_VERSION_1200"><code>SCHEMA_VERSION_1200</code></a>.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../soc/server/database/SOCDBHelper.html#SCHEMA_VERSION_LATEST">SCHEMA_VERSION_LATEST</a></span></code>
<div class="block">Latest version of the JSettlers schema, currently 2.0.00 (<a href="../../../soc/server/database/SOCDBHelper.html#SCHEMA_VERSION_2000"><code>SCHEMA_VERSION_2000</code></a>).</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../soc/server/database/SOCDBHelper.html#SCHEMA_VERSION_ORIGINAL">SCHEMA_VERSION_ORIGINAL</a></span></code>
<div class="block">Original JSettlers schema version (1.0.00), before any new extra tables/fields.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../soc/server/database/SOCDBHelper.html#SETTING_BCRYPT_WORK__FACTOR">SETTING_BCRYPT_WORK__FACTOR</a></span></code>
<div class="block"><code>Settings</code> table key for the <a href="../../../soc/server/database/SOCDBHelper.html#PW_SCHEME_BCRYPT"><code>PW_SCHEME_BCRYPT</code></a> Work Factor.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../soc/server/database/SOCDBHelper.html#SOCDBHelper--">SOCDBHelper</a></span>()</code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t1" class="tableTab"><span><a href="javascript:show(1);">Static Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../soc/server/database/SOCDBHelper.html#authenticateUserPassword-java.lang.String-java.lang.String-soc.server.database.SOCDBHelper.AuthPasswordRunnable-">authenticateUserPassword</a></span>(java.lang.String&nbsp;sUserName,
                        java.lang.String&nbsp;sPassword,
                        <a href="../../../soc/server/database/SOCDBHelper.AuthPasswordRunnable.html" title="interface in soc.server.database">SOCDBHelper.AuthPasswordRunnable</a>&nbsp;authCallback)</code>
<div class="block">Check if this user exists, if so validate their password from the database.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../soc/server/database/SOCDBHelper.html#checkSettings-boolean-boolean-">checkSettings</a></span>(boolean&nbsp;checkAll,
             boolean&nbsp;writeIfNeeded)</code>
<div class="block">Check the <code>settings</code> table for optional db-related properties and their fields:

  Set <a href="../../../soc/server/database/SOCDBHelper.html#bcryptWorkFactor"><code>bcryptWorkFactor</code></a> from <code>settings</code>(<a href="../../../soc/server/database/SOCDBHelper.html#SETTING_BCRYPT_WORK__FACTOR"><code>SETTING_BCRYPT_WORK__FACTOR</code></a>)
      unless <a href="../../../soc/server/database/SOCDBHelper.html#props"><code>props</code></a> contains <a href="../../../soc/server/database/SOCDBHelper.html#PROP_JSETTLERS_DB_BCRYPT_WORK__FACTOR"><code>PROP_JSETTLERS_DB_BCRYPT_WORK__FACTOR</code></a>.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../soc/server/database/SOCDBHelper.html#cleanup-boolean-">cleanup</a></span>(boolean&nbsp;isForShutdown)</code>
<div class="block">Close out and shut down the database connection.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../soc/server/database/SOCDBHelper.html#countUsers--">countUsers</a></span>()</code>
<div class="block">Count the number of users, if any, currently in the users table.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../soc/server/database/SOCDBHelper.html#createAccount-java.lang.String-java.lang.String-java.lang.String-java.lang.String-long-">createAccount</a></span>(java.lang.String&nbsp;userName,
             java.lang.String&nbsp;host,
             java.lang.String&nbsp;password,
             java.lang.String&nbsp;email,
             long&nbsp;time)</code>
<div class="block">Attempt to create a new account with a unique <code>userName</code> (nickname) in the <code>users</code> table.</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>(package private) static void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../soc/server/database/SOCDBHelper.html#dispResultSet-java.sql.ResultSet-">dispResultSet</a></span>(java.sql.ResultSet&nbsp;rs)</code>&nbsp;</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../soc/server/database/SOCDBHelper.html#doesSchemaUpgradeNeedBGTasks--">doesSchemaUpgradeNeedBGTasks</a></span>()</code>
<div class="block">For the currently connected DB, are any background tasks needed to complete a recent <a href="../../../soc/server/database/SOCDBHelper.html#upgradeSchema-java.util.Set-"><code>upgradeSchema(Set)</code></a>?</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../soc/server/database/SOCDBHelper.html#doesTableColumnExist-java.lang.String-java.lang.String-">doesTableColumnExist</a></span>(java.lang.String&nbsp;tabname,
                    java.lang.String&nbsp;colname)</code>
<div class="block">Query to see if a column exists in a table.</div>
</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../soc/server/database/SOCDBHelper.html#doesTableExist-java.lang.String-">doesTableExist</a></span>(java.lang.String&nbsp;tabname)</code>
<div class="block">Query to see if a table exists in the database.</div>
</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../soc/server/database/SOCDBHelper.html#getMaxPasswordLength--">getMaxPasswordLength</a></span>()</code>
<div class="block">Get the maximum password length, given the current schema version's encoding scheme
 (<a href="../../../soc/server/database/SOCDBHelper.html#PW_SCHEME_BCRYPT"><code>PW_SCHEME_BCRYPT</code></a> or <a href="../../../soc/server/database/SOCDBHelper.html#PW_SCHEME_NONE"><code>PW_SCHEME_NONE</code></a>).</div>
</td>
</tr>
<tr id="i10" class="altColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../soc/server/database/SOCDBHelper.html#getSchemaVersion--">getSchemaVersion</a></span>()</code>
<div class="block">Get the detected schema version of the currently connected database.</div>
</td>
</tr>
<tr id="i11" class="rowColor">
<td class="colFirst"><code>java.util.List&lt;java.lang.String&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../soc/server/database/SOCDBHelper.html#getSettingsFormatted-soc.server.SOCServer-">getSettingsFormatted</a></span>(<a href="../../../soc/server/SOCServer.html" title="class in soc.server">SOCServer</a>&nbsp;srv)</code>
<div class="block">Build a list of DB settings and related info like <a href="../../../soc/server/database/SOCDBHelper.html#getSchemaVersion--"><code>getSchemaVersion()</code></a> and the BCrypt work factor,
 formatted for printing for an admin user: friendly names and values, not technical name keys.</div>
</td>
</tr>
<tr id="i12" class="altColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../soc/server/database/SOCDBHelper.html#getUser-java.lang.String-">getUser</a></span>(java.lang.String&nbsp;userName)</code>
<div class="block">Search for and return this user (nickname) if it exists in the database.</div>
</td>
</tr>
<tr id="i13" class="rowColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../soc/server/database/SOCDBHelper.html#getUserFromHost-java.lang.String-">getUserFromHost</a></span>(java.lang.String&nbsp;host)</code>
<div class="block">DOCUMENT ME!</div>
</td>
</tr>
<tr id="i14" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../soc/server/database/SOCDBHelper.html#initialize-java.lang.String-java.lang.String-java.util.Properties-">initialize</a></span>(java.lang.String&nbsp;user,
          java.lang.String&nbsp;pswd,
          java.util.Properties&nbsp;dbProps)</code>
<div class="block">This makes a connection to the database
 and initializes the prepared statements.</div>
</td>
</tr>
<tr id="i15" class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../soc/server/database/SOCDBHelper.html#isInitialized--">isInitialized</a></span>()</code>
<div class="block">Were we able to <a href="../../../soc/server/database/SOCDBHelper.html#initialize-java.lang.String-java.lang.String-java.util.Properties-"><code>initialize(String, String, Properties)</code></a>
 and connect to the database?</div>
</td>
</tr>
<tr id="i16" class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../soc/server/database/SOCDBHelper.html#isPasswordLengthOK-java.lang.String-">isPasswordLengthOK</a></span>(java.lang.String&nbsp;password)</code>
<div class="block">Is this password's nonzero length less than or equal to the current maximum, given the current schema version's
 password encoding scheme (<a href="../../../soc/server/database/SOCDBHelper.html#PW_SCHEME_BCRYPT"><code>PW_SCHEME_BCRYPT</code></a> or <a href="../../../soc/server/database/SOCDBHelper.html#PW_SCHEME_NONE"><code>PW_SCHEME_NONE</code></a>)?</div>
</td>
</tr>
<tr id="i17" class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../soc/server/database/SOCDBHelper.html#isSchemaLatestVersion--">isSchemaLatestVersion</a></span>()</code>
<div class="block">Does the currently connected DB have the latest schema, with all optional fields?</div>
</td>
</tr>
<tr id="i18" class="altColor">
<td class="colFirst"><code>java.util.Map&lt;java.lang.String,java.util.List&lt;java.lang.String&gt;&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../soc/server/database/SOCDBHelper.html#queryUsersDuplicateLCase-java.util.Set-">queryUsersDuplicateLCase</a></span>(java.util.Set&lt;java.lang.String&gt;&nbsp;out_allNames)</code>
<div class="block">Query all users to find any 'duplicate' user names, according to
 <code>String.toLowercase</code>
 (<code>Locale.US</code>).</div>
</td>
</tr>
<tr id="i19" class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../soc/server/database/SOCDBHelper.html#recordLogin-java.lang.String-java.lang.String-long-">recordLogin</a></span>(java.lang.String&nbsp;userName,
           java.lang.String&nbsp;host,
           long&nbsp;time)</code>
<div class="block">Record this user's login host and time.</div>
</td>
</tr>
<tr id="i20" class="altColor">
<td class="colFirst"><code><a href="../../../soc/util/SOCRobotParameters.html" title="class in soc.util">SOCRobotParameters</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../soc/server/database/SOCDBHelper.html#retrieveRobotParams-java.lang.String-">retrieveRobotParams</a></span>(java.lang.String&nbsp;robotName)</code>
<div class="block">Get this robot's specialized parameters from the database, if it has an entry there.</div>
</td>
</tr>
<tr id="i21" class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../soc/server/database/SOCDBHelper.html#saveGameScores-soc.game.SOCGame-int-boolean-">saveGameScores</a></span>(<a href="../../../soc/game/SOCGame.html" title="class in soc.game">SOCGame</a>&nbsp;ga,
              int&nbsp;gameLengthSeconds,
              boolean&nbsp;winLossOnly)</code>
<div class="block">Record this completed game's time, players, scores, and game options in the database.</div>
</td>
</tr>
<tr id="i22" class="altColor">
<td class="colFirst"><code>java.sql.ResultSet</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../soc/server/database/SOCDBHelper.html#selectWithLimit-java.lang.String-int-">selectWithLimit</a></span>(java.lang.String&nbsp;selectStmt,
               int&nbsp;limit)</code>
<div class="block">Build and run a SELECT query, with a LIMIT clause appropriate to the DB type if possible.</div>
</td>
</tr>
<tr id="i23" class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../soc/server/database/SOCDBHelper.html#startSchemaUpgradeBGTasks--">startSchemaUpgradeBGTasks</a></span>()</code>
<div class="block">If not already running, start a thread to do any background tasks needed to complete a
 recent <a href="../../../soc/server/database/SOCDBHelper.html#upgradeSchema-java.util.Set-"><code>upgradeSchema(Set)</code></a>.</div>
</td>
</tr>
<tr id="i24" class="altColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../soc/server/database/SOCDBHelper.html#testBCryptSpeed--">testBCryptSpeed</a></span>()</code>
<div class="block">Run timing tests for <a href="../../../soc/server/database/BCrypt.html" title="class in soc.server.database"><code>BCrypt</code></a> at various work factors, and print results to <code>System.err</code>.</div>
</td>
</tr>
<tr id="i25" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../soc/server/database/SOCDBHelper.html#testDBHelper--">testDBHelper</a></span>()</code>
<div class="block">Tests for a working database connection, unit tests for <a href="../../../soc/server/database/SOCDBHelper.html" title="class in soc.server.database"><code>SOCDBHelper</code></a> methods.</div>
</td>
</tr>
<tr id="i26" class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../soc/server/database/SOCDBHelper.html#updateLastlogin-java.lang.String-long-">updateLastlogin</a></span>(java.lang.String&nbsp;userName,
               long&nbsp;time)</code>
<div class="block">DOCUMENT ME!</div>
</td>
</tr>
<tr id="i27" class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../soc/server/database/SOCDBHelper.html#updateUserPassword-java.lang.String-java.lang.String-">updateUserPassword</a></span>(java.lang.String&nbsp;userName,
                  java.lang.String&nbsp;newPassword)</code>
<div class="block">Update a user's password if the user is in the database.</div>
</td>
</tr>
<tr id="i28" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../soc/server/database/SOCDBHelper.html#upgradeSchema-java.util.Set-">upgradeSchema</a></span>(java.util.Set&lt;java.lang.String&gt;&nbsp;userAdmins)</code>
<div class="block">Perform pre-checks and upgrade the currently connected DB to the latest schema, with all optional fields.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="PROP_JSETTLERS_DB_USER">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>PROP_JSETTLERS_DB_USER</h4>
<pre>public static final&nbsp;java.lang.String PROP_JSETTLERS_DB_USER</pre>
<div class="block">Property <tt>jsettlers.db.user</tt> to specify the server's SQL database username.
 Default is <tt>"socuser"</tt>.</div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.1.09</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#soc.server.database.SOCDBHelper.PROP_JSETTLERS_DB_USER">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="PROP_JSETTLERS_DB_PASS">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>PROP_JSETTLERS_DB_PASS</h4>
<pre>public static final&nbsp;java.lang.String PROP_JSETTLERS_DB_PASS</pre>
<div class="block">Property <tt>jsettlers.db.pass</tt> to specify the server's SQL database password.
 Default is <tt>"socpass"</tt>.
 v2.0.00 and higher allow a blank password ("").</div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.1.09</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#soc.server.database.SOCDBHelper.PROP_JSETTLERS_DB_PASS">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="PROP_JSETTLERS_DB_JAR">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>PROP_JSETTLERS_DB_JAR</h4>
<pre>public static final&nbsp;java.lang.String PROP_JSETTLERS_DB_JAR</pre>
<div class="block">Property <tt>jsettlers.db.jar</tt> to specify the JAR filename for the server's JDBC driver.
 This is required when running a JAR file, since JVM will ignore CLASSPATH.
<P>
 Default is blank (no driver jar file), since the filename varies when used.</div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.1.15</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#soc.server.database.SOCDBHelper.PROP_JSETTLERS_DB_JAR">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="PROP_JSETTLERS_DB_DRIVER">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>PROP_JSETTLERS_DB_DRIVER</h4>
<pre>public static final&nbsp;java.lang.String PROP_JSETTLERS_DB_DRIVER</pre>
<div class="block">Property <tt>jsettlers.db.driver</tt> to specify the server's JDBC driver class.
 The default driver is "com.mysql.jdbc.Driver".
 If the <a href="../../../soc/server/database/SOCDBHelper.html#PROP_JSETTLERS_DB_URL"><code>URL</code></a> begins with "jdbc:postgresql:",
 the driver will be "org.postgresql.Driver".
 If the <tt>URL</tt> begins with "jdbc:sqlite:",
 the driver will be "org.sqlite.JDBC".</div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.1.09</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#soc.server.database.SOCDBHelper.PROP_JSETTLERS_DB_DRIVER">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="PROP_JSETTLERS_DB_URL">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>PROP_JSETTLERS_DB_URL</h4>
<pre>public static final&nbsp;java.lang.String PROP_JSETTLERS_DB_URL</pre>
<div class="block">Property <tt>jsettlers.db.url</tt> to specify the server's URL.
 The default URL is "jdbc:mysql://localhost/socdata".</div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.1.09</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#soc.server.database.SOCDBHelper.PROP_JSETTLERS_DB_URL">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="PROP_JSETTLERS_DB_SETTINGS">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>PROP_JSETTLERS_DB_SETTINGS</h4>
<pre>public static final&nbsp;java.lang.String PROP_JSETTLERS_DB_SETTINGS</pre>
<div class="block">Utility property <tt>jsettlers.db.settings</tt> to write the values of settings properties
 like <a href="../../../soc/server/database/SOCDBHelper.html#PROP_JSETTLERS_DB_BCRYPT_WORK__FACTOR"><code>PROP_JSETTLERS_DB_BCRYPT_WORK__FACTOR</code></a> to the <code>settings</code> table.
 Run SOCServer with this property to update the table after startup fails with
 a <a href="../../../soc/server/database/DBSettingMismatchException.html" title="class in soc.server.database"><code>DBSettingMismatchException</code></a>.
<P>
 This property's only valid value is <code>"write"</code> (value does not include the double quote marks).
 Other values will be rejected during <a href="../../../soc/server/database/SOCDBHelper.html#initialize-java.lang.String-java.lang.String-java.util.Properties-"><code>initialize(String, String, Properties)</code></a>.</div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.2.00</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#soc.server.database.SOCDBHelper.PROP_JSETTLERS_DB_SETTINGS">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="PROP_JSETTLERS_DB_BCRYPT_WORK__FACTOR">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>PROP_JSETTLERS_DB_BCRYPT_WORK__FACTOR</h4>
<pre>public static final&nbsp;java.lang.String PROP_JSETTLERS_DB_BCRYPT_WORK__FACTOR</pre>
<div class="block">Integer property <tt>jsettlers.db.bcrypt.work_factor</tt> to set or test the <a href="../../../soc/server/database/BCrypt.html" title="class in soc.server.database"><code>BCrypt</code></a> work factor
 (password hashing round count's power of 2, see <a href="../../../soc/server/database/BCrypt.html#gensalt-int-"><code>BCrypt.gensalt(int)</code></a> for details).
 Used with <a href="../../../soc/server/database/SOCDBHelper.html#PW_SCHEME_BCRYPT"><code>PW_SCHEME_BCRYPT</code></a>.
<P>
 This property overrides <a href="../../../soc/server/database/SOCDBHelper.html#SETTING_BCRYPT_WORK__FACTOR"><code>SETTING_BCRYPT_WORK__FACTOR</code></a>'s value.
<P>
 If this prop's value is <code>"test"</code> instead of an integer, server calls <a href="../../../soc/server/database/SOCDBHelper.html#testBCryptSpeed--"><code>testBCryptSpeed()</code></a>.
<P>
 During initial DB setup or schema upgrade from <a href="../../../soc/server/database/SOCDBHelper.html#SCHEMA_VERSION_ORIGINAL"><code>SCHEMA_VERSION_ORIGINAL</code></a>, the work factor
 is saved to the <code>settings</code> table.</div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.2.00</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#soc.server.database.SOCDBHelper.PROP_JSETTLERS_DB_BCRYPT_WORK__FACTOR">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="PROP_JSETTLERS_DB_SCRIPT_SETUP">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>PROP_JSETTLERS_DB_SCRIPT_SETUP</h4>
<pre>public static final&nbsp;java.lang.String PROP_JSETTLERS_DB_SCRIPT_SETUP</pre>
<div class="block">Property <tt>jsettlers.db.script.setup</tt> to run a SQL setup script
 at server startup, then exit.  Used to create tables when setting up a server.
 To activate this mode, set this to the SQL script's full path or relative path.
<P>
 To implement this, the SOCServer constructor connects to the db and runs the setup script,
 then signals success by throwing an <code>EOFException</code> which is
 caught by <code>main(..)</code>.  Errors throw <code>SQLException</code> instead.</div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.1.15</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#soc.server.database.SOCDBHelper.PROP_JSETTLERS_DB_SCRIPT_SETUP">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="PROP_JSETTLERS_DB_UPGRADE__SCHEMA">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>PROP_JSETTLERS_DB_UPGRADE__SCHEMA</h4>
<pre>public static final&nbsp;java.lang.String PROP_JSETTLERS_DB_UPGRADE__SCHEMA</pre>
<div class="block">Boolean property <code>jsettlers.db.upgrade_schema</code> to run <a href="../../../soc/server/database/SOCDBHelper.html#upgradeSchema-java.util.Set-"><code>upgradeSchema(Set)</code></a>
 at server startup, then exit. To activate this mode, set this to true.
<P>
 Same SOCServer semantics/exceptions as <a href="../../../soc/server/database/SOCDBHelper.html#PROP_JSETTLERS_DB_SCRIPT_SETUP"><code>PROP_JSETTLERS_DB_SCRIPT_SETUP</code></a>,
 see that property's javadoc for details.</div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.2.00</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#soc.server.database.SOCDBHelper.PROP_JSETTLERS_DB_UPGRADE__SCHEMA">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="PROP_JSETTLERS_DB_SAVE_GAMES">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>PROP_JSETTLERS_DB_SAVE_GAMES</h4>
<pre>public static final&nbsp;java.lang.String PROP_JSETTLERS_DB_SAVE_GAMES</pre>
<div class="block">Property <tt>jsettlers.db.save.games</tt> to ask to save
 all game results and scores in the database.
 Set this to 1 or Y to activate this feature.
<P>
 If not set, but DB schema is new enough to save users' win-loss counts
 (<a href="../../../soc/server/database/SOCDBHelper.html#SCHEMA_VERSION_2000"><code>SCHEMA_VERSION_2000</code></a>), those per-user counts will still be updated.</div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.1.15</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#soc.server.database.SOCDBHelper.PROP_JSETTLERS_DB_SAVE_GAMES">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="PROP_IMPL_JSETTLERS_PW_RESET">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>PROP_IMPL_JSETTLERS_PW_RESET</h4>
<pre>public static final&nbsp;java.lang.String PROP_IMPL_JSETTLERS_PW_RESET</pre>
<div class="block">Internal property name used to hold the <tt>--pw-reset</tt> command line argument's username.
 When present at server startup, the server will prompt and reset the password if the user exists,
 then exit.
<P>
 This is a Utility Mode parameter; not for use in property files, because the server always exits
 after trying to change the password.
<P>
 As with <a href="../../../soc/server/database/SOCDBHelper.html#PROP_JSETTLERS_DB_SCRIPT_SETUP"><code>PROP_JSETTLERS_DB_SCRIPT_SETUP</code></a>, the SOCServer constructor throws either
 <code>EOFException</code> or <code>SQLException</code> (for success or failure)
 which are caught by <code>main(..)</code>.</div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.1.20</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#soc.server.database.SOCDBHelper.PROP_IMPL_JSETTLERS_PW_RESET">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="PROP_SQLITE_TMPDIR">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>PROP_SQLITE_TMPDIR</h4>
<pre>public static final&nbsp;java.lang.String PROP_SQLITE_TMPDIR</pre>
<div class="block">For convenience/reference, the JVM property name that xerial sqlite-jdbc uses
 when extracting its native library to a non-default temp directory.
<P>
 JSettlers server v2.2.00 and newer will set the JVM property if it's not already set
 but is in <code>jsserver.properties</code> file or the server command line.</div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>2.2.00</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#soc.server.database.SOCDBHelper.PROP_SQLITE_TMPDIR">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="SCHEMA_VERSION_ORIGINAL">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>SCHEMA_VERSION_ORIGINAL</h4>
<pre>public static final&nbsp;int SCHEMA_VERSION_ORIGINAL</pre>
<div class="block">Original JSettlers schema version (1.0.00), before any new extra tables/fields.
 <code>games</code> table has columns for only 4 players' names and scores, not 6.
<P>
 Next version (but not latest) is <a href="../../../soc/server/database/SOCDBHelper.html#SCHEMA_VERSION_1200"><code>SCHEMA_VERSION_1200</code></a>.</div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.2.00</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../soc/server/database/SOCDBHelper.html#SCHEMA_VERSION_LATEST"><code>SCHEMA_VERSION_LATEST</code></a>, 
<a href="../../../constant-values.html#soc.server.database.SOCDBHelper.SCHEMA_VERSION_ORIGINAL">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="SCHEMA_VERSION_1200">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>SCHEMA_VERSION_1200</h4>
<pre>public static final&nbsp;int SCHEMA_VERSION_1200</pre>
<div class="block">First updated JSettlers schema version (1.2.00) which adds any new extra tables/fields.
<UL>
 <LI> <code>db_version</code> table with upgrade history
 <LI> <code>settings</code> table
 <LI> Added fields to <code>games</code> and <code>users</code>; see <code>Versions.md</code> for details
</UL>
 Next version is <a href="../../../soc/server/database/SOCDBHelper.html#SCHEMA_VERSION_2000"><code>SCHEMA_VERSION_2000</code></a>.</div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.2.00</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../soc/server/database/SOCDBHelper.html#SCHEMA_VERSION_ORIGINAL"><code>SCHEMA_VERSION_ORIGINAL</code></a>, 
<a href="../../../soc/server/database/SOCDBHelper.html#SCHEMA_VERSION_LATEST"><code>SCHEMA_VERSION_LATEST</code></a>, 
<a href="../../../constant-values.html#soc.server.database.SOCDBHelper.SCHEMA_VERSION_1200">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="SCHEMA_VERSION_2000">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>SCHEMA_VERSION_2000</h4>
<pre>public static final&nbsp;int SCHEMA_VERSION_2000</pre>
<div class="block">JSettlers schema version 2.0.00, with extra tables/fields added since <a href="../../../soc/server/database/SOCDBHelper.html#SCHEMA_VERSION_1200"><code>SCHEMA_VERSION_1200</code></a>.
<UL>
 <LI> <code>users</code>: Added games_won, games_lost fields
 <LI> <code>games</code>: Obsoleted by <code>games2</code>. Upgrade won't delete it, but new games won't be added to it
 <LI> <code>games2</code>: Normalized <code>games</code> table with per-player sub-table, also added scenario field
 <LI> <code>games2_players</code>: Sub-table: Score for 1 player in a game
</UL></div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>2.0.00</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../soc/server/database/SOCDBHelper.html#SCHEMA_VERSION_ORIGINAL"><code>SCHEMA_VERSION_ORIGINAL</code></a>, 
<a href="../../../soc/server/database/SOCDBHelper.html#SCHEMA_VERSION_LATEST"><code>SCHEMA_VERSION_LATEST</code></a>, 
<a href="../../../constant-values.html#soc.server.database.SOCDBHelper.SCHEMA_VERSION_2000">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="SCHEMA_VERSION_LATEST">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>SCHEMA_VERSION_LATEST</h4>
<pre>public static final&nbsp;int SCHEMA_VERSION_LATEST</pre>
<div class="block">Latest version of the JSettlers schema, currently 2.0.00 (<a href="../../../soc/server/database/SOCDBHelper.html#SCHEMA_VERSION_2000"><code>SCHEMA_VERSION_2000</code></a>).</div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.2.00</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../soc/server/database/SOCDBHelper.html#isSchemaLatestVersion--"><code>isSchemaLatestVersion()</code></a>, 
<a href="../../../constant-values.html#soc.server.database.SOCDBHelper.SCHEMA_VERSION_LATEST">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="PW_SCHEME_NONE">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>PW_SCHEME_NONE</h4>
<pre>public static final&nbsp;int PW_SCHEME_NONE</pre>
<div class="block">No password encoding scheme: plain text.
 This scheme is <code>null</code> in <code>users.pw_scheme</code> database field,
 password is stored in <code>users.password</code>.
 Maximum length is <a href="../../../soc/server/database/SOCDBHelper.html#PW_MAX_LEN_SCHEME_NONE"><code>PW_MAX_LEN_SCHEME_NONE</code></a>; clients before v1.2.00
 truncated longer passwords before sending them to the server.
<P>
 Used in versions before <a href="../../../soc/server/database/SOCDBHelper.html#SCHEMA_VERSION_1200"><code>SCHEMA_VERSION_1200</code></a>.</div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.2.00</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../soc/server/database/SOCDBHelper.html#PW_SCHEME_BCRYPT"><code>PW_SCHEME_BCRYPT</code></a>, 
<a href="../../../constant-values.html#soc.server.database.SOCDBHelper.PW_SCHEME_NONE">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="PW_SCHEME_BCRYPT">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>PW_SCHEME_BCRYPT</h4>
<pre>public static final&nbsp;int PW_SCHEME_BCRYPT</pre>
<div class="block">Password encoding scheme #1: <a href="../../../soc/server/database/BCrypt.html" title="class in soc.server.database"><code>BCrypt</code></a>.
 Scheme is stored in <code>users.pw_scheme</code> database field,
 encoded password stored in <code>users.pw_store</code>.
 Work Factor can be specified with <a href="../../../soc/server/database/SOCDBHelper.html#PROP_JSETTLERS_DB_BCRYPT_WORK__FACTOR"><code>PROP_JSETTLERS_DB_BCRYPT_WORK__FACTOR</code></a>
 or <tt>settings(<a href="../../../soc/server/database/SOCDBHelper.html#SETTING_BCRYPT_WORK__FACTOR"><code>SETTING_BCRYPT_WORK__FACTOR</code></a>)</tt>,
 and tested with <a href="../../../soc/server/database/SOCDBHelper.html#testBCryptSpeed--"><code>testBCryptSpeed()</code></a>.
 Maximum password length is <a href="../../../soc/server/database/SOCDBHelper.html#PW_MAX_LEN_SCHEME_BCRYPT"><code>PW_MAX_LEN_SCHEME_BCRYPT</code></a>.
<P>
 The old field <code>users.password</code> is unused, ignored, and contains '!'
 because the older schema specified NOT NULL and sqlite can't alter fields.
<P>
 Used with <a href="../../../soc/server/database/SOCDBHelper.html#SCHEMA_VERSION_1200"><code>SCHEMA_VERSION_1200</code></a> and higher.</div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.2.00</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../soc/server/database/SOCDBHelper.html#PW_SCHEME_NONE"><code>PW_SCHEME_NONE</code></a>, 
<a href="../../../constant-values.html#soc.server.database.SOCDBHelper.PW_SCHEME_BCRYPT">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="BCRYPT_MIN_WORK_FACTOR">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>BCRYPT_MIN_WORK_FACTOR</h4>
<pre>public static final&nbsp;int BCRYPT_MIN_WORK_FACTOR</pre>
<div class="block">Minimum Work Factor (9) allowed for <a href="../../../soc/server/database/SOCDBHelper.html#PW_SCHEME_BCRYPT"><code>PW_SCHEME_BCRYPT</code></a> encoding in JSettlers:
 see <a href="../../../soc/server/database/SOCDBHelper.html#BCRYPT_DEFAULT_WORK_FACTOR"><code>BCRYPT_DEFAULT_WORK_FACTOR</code></a> for details. Anything below 9 is too fast.</div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.2.00</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#soc.server.database.SOCDBHelper.BCRYPT_MIN_WORK_FACTOR">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="BCRYPT_DEFAULT_WORK_FACTOR">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>BCRYPT_DEFAULT_WORK_FACTOR</h4>
<pre>public static final&nbsp;int BCRYPT_DEFAULT_WORK_FACTOR</pre>
<div class="block">Default Work Factor (12) for <a href="../../../soc/server/database/SOCDBHelper.html#PW_SCHEME_BCRYPT"><code>PW_SCHEME_BCRYPT</code></a> encoding in JSettlers:
 Password hashing round count's power of 2, see <a href="../../../soc/server/database/BCrypt.html#gensalt-int-"><code>BCrypt.gensalt(int)</code></a> for details.</div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.2.00</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../soc/server/database/BCrypt.html#GENSALT_MAX_LOG2_ROUNDS"><code>BCrypt.GENSALT_MAX_LOG2_ROUNDS</code></a>, 
<a href="../../../soc/server/database/SOCDBHelper.html#PROP_JSETTLERS_DB_BCRYPT_WORK__FACTOR"><code>PROP_JSETTLERS_DB_BCRYPT_WORK__FACTOR</code></a>, 
<a href="../../../soc/server/database/SOCDBHelper.html#SETTING_BCRYPT_WORK__FACTOR"><code>SETTING_BCRYPT_WORK__FACTOR</code></a>, 
<a href="../../../soc/server/database/SOCDBHelper.html#testBCryptSpeed--"><code>testBCryptSpeed()</code></a>, 
<a href="../../../constant-values.html#soc.server.database.SOCDBHelper.BCRYPT_DEFAULT_WORK_FACTOR">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="PW_MAX_LEN_SCHEME_NONE">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>PW_MAX_LEN_SCHEME_NONE</h4>
<pre>public static final&nbsp;int PW_MAX_LEN_SCHEME_NONE</pre>
<div class="block">Original max length for a JSettlers account password when using <a href="../../../soc/server/database/SOCDBHelper.html#PW_SCHEME_NONE"><code>PW_SCHEME_NONE</code></a>.</div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.2.00</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../soc/server/database/SOCDBHelper.html#isPasswordLengthOK-java.lang.String-"><code>isPasswordLengthOK(String)</code></a>, 
<a href="../../../constant-values.html#soc.server.database.SOCDBHelper.PW_MAX_LEN_SCHEME_NONE">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="PW_MAX_LEN_SCHEME_BCRYPT">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>PW_MAX_LEN_SCHEME_BCRYPT</h4>
<pre>public static final&nbsp;int PW_MAX_LEN_SCHEME_BCRYPT</pre>
<div class="block">Max length for a JSettlers account password when using <a href="../../../soc/server/database/SOCDBHelper.html#PW_SCHEME_BCRYPT"><code>PW_SCHEME_BCRYPT</code></a>. <a href="../../../soc/server/database/BCrypt.html" title="class in soc.server.database"><code>BCrypt</code></a> encrypts
 the password's bytes as encoded in UTF-8. Check against that length, not <code>String.length()</code>;
 <a href="../../../soc/server/database/SOCDBHelper.html#isPasswordLengthOK-java.lang.String-"><code>isPasswordLengthOK(String)</code></a> does so.
<P>
 Higher lengths (72) were tested successfully in <code>soctest.db.TestBCryptMisc</code> with ASCII characters,
 this max value is lower for compatibility with other BCrypt implementations.</div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.2.00</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#soc.server.database.SOCDBHelper.PW_MAX_LEN_SCHEME_BCRYPT">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="SETTING_BCRYPT_WORK__FACTOR">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>SETTING_BCRYPT_WORK__FACTOR</h4>
<pre>public static final&nbsp;java.lang.String SETTING_BCRYPT_WORK__FACTOR</pre>
<div class="block"><code>Settings</code> table key for the <a href="../../../soc/server/database/SOCDBHelper.html#PW_SCHEME_BCRYPT"><code>PW_SCHEME_BCRYPT</code></a> Work Factor.
 If present, <a href="../../../soc/server/database/SOCDBHelper.html#PROP_JSETTLERS_DB_BCRYPT_WORK__FACTOR"><code>PROP_JSETTLERS_DB_BCRYPT_WORK__FACTOR</code></a> overrides this setting's value;
 see its javadoc for details on the Work Factor.</div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.2.00</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../soc/server/database/SOCDBHelper.html#BCRYPT_DEFAULT_WORK_FACTOR"><code>BCRYPT_DEFAULT_WORK_FACTOR</code></a>, 
<a href="../../../constant-values.html#soc.server.database.SOCDBHelper.SETTING_BCRYPT_WORK__FACTOR">Constant Field Values</a></dd>
</dl>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="SOCDBHelper--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>SOCDBHelper</h4>
<pre>public&nbsp;SOCDBHelper()</pre>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="initialize-java.lang.String-java.lang.String-java.util.Properties-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>initialize</h4>
<pre>public&nbsp;void&nbsp;initialize(java.lang.String&nbsp;user,
                       java.lang.String&nbsp;pswd,
                       java.util.Properties&nbsp;dbProps)
                throws java.lang.IllegalArgumentException,
                       <a href="../../../soc/server/database/DBSettingMismatchException.html" title="class in soc.server.database">DBSettingMismatchException</a>,
                       java.sql.SQLException,
                       java.io.IOException</pre>
<div class="block">This makes a connection to the database
 and initializes the prepared statements.
 (If <tt>props</tt> includes <a href="../../../soc/server/database/SOCDBHelper.html#PROP_JSETTLERS_DB_SCRIPT_SETUP"><code>PROP_JSETTLERS_DB_SCRIPT_SETUP</code></a>,
 runs that script before the prepared statements.)
 Sets <a href="../../../soc/server/database/SOCDBHelper.html#isInitialized--"><code>isInitialized()</code></a> and <a href="../../../soc/server/database/SOCDBHelper.html#getSchemaVersion--"><code>getSchemaVersion()</code></a>. Calls
 <a href="../../../soc/server/database/SOCDBHelper.html#checkSettings-boolean-boolean-"><code>checkSettings(false, setupScript != null)</code></a>
 to look for inconsistent or missing <code>settings</code> entries and (if running a setup
 script) save those settings.
<P>
 The default URL is "jdbc:mysql://localhost/socdata".
 The default driver is "com.mysql.jdbc.Driver".
 These can be changed by supplying <code>props</code>.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>user</code> - the user name for accessing the database, or <code>null</code> to not attempt connection</dd>
<dd><code>pswd</code> - the password for the user, or ""</dd>
<dd><code>dbProps</code> - null, or properties containing <a href="../../../soc/server/database/SOCDBHelper.html#PROP_JSETTLERS_DB_DRIVER"><code>PROP_JSETTLERS_DB_DRIVER</code></a>,
       <a href="../../../soc/server/database/SOCDBHelper.html#PROP_JSETTLERS_DB_URL"><code>PROP_JSETTLERS_DB_URL</code></a>, and any other desired properties.
       Ignores <a href="../../../soc/server/database/SOCDBHelper.html#PROP_JSETTLERS_DB_USER"><code>PROP_JSETTLERS_DB_USER</code></a> and <a href="../../../soc/server/database/SOCDBHelper.html#PROP_JSETTLERS_DB_PASS"><code>PROP_JSETTLERS_DB_PASS</code></a> if present,
       uses the <code>user</code> and <code>pswd</code> parameters instead.
       <P>
       If <code>props</code> contains <a href="../../../soc/server/database/SOCDBHelper.html#PROP_JSETTLERS_DB_SETTINGS"><code>PROP_JSETTLERS_DB_SETTINGS</code></a> == "write"</tt>,
       the <code>settings</code> table will be updated from props or default values as needed.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - if there are problems with <code>props</code> contents:
         <UL>
           <LI> <a href="../../../soc/server/database/SOCDBHelper.html#PROP_JSETTLERS_DB_URL"><code>PROP_JSETTLERS_DB_URL</code></a> property doesn't use a recognized scheme
               (<code>jdbc:mariadb</code>, <code>jdbc:mysql</code>, <code>:postgresql</code>, or <code>:sqlite</code>)
               but <a href="../../../soc/server/database/SOCDBHelper.html#PROP_JSETTLERS_DB_DRIVER"><code>PROP_JSETTLERS_DB_DRIVER</code></a> isn't provided
           <LI> <a href="../../../soc/server/database/SOCDBHelper.html#PROP_JSETTLERS_DB_DRIVER"><code>PROP_JSETTLERS_DB_DRIVER</code></a> isn't recognized as mariadb, mysql, postgres, or sqlite,
               but <a href="../../../soc/server/database/SOCDBHelper.html#PROP_JSETTLERS_DB_URL"><code>PROP_JSETTLERS_DB_URL</code></a> isn't provided
           <LI> <a href="../../../soc/server/database/SOCDBHelper.html#PROP_JSETTLERS_DB_BCRYPT_WORK__FACTOR"><code>PROP_JSETTLERS_DB_BCRYPT_WORK__FACTOR</code></a> is out of range
               (9 to <a href="../../../soc/server/database/BCrypt.html#GENSALT_MAX_LOG2_ROUNDS"><code>BCrypt.GENSALT_MAX_LOG2_ROUNDS</code></a>) or can't be parsed as an integer
           <LI> <a href="../../../soc/server/database/SOCDBHelper.html#PROP_JSETTLERS_DB_SETTINGS"><code>PROP_JSETTLERS_DB_SETTINGS</code></a> is provided but isn't <code>"write"</code>
         </UL></dd>
<dd><code><a href="../../../soc/server/database/DBSettingMismatchException.html" title="class in soc.server.database">DBSettingMismatchException</a></code> - if <code>props</code> contains one or more properties which are
         also in the <code>settings</code> table but with different values; this method's call to
         <a href="../../../soc/server/database/SOCDBHelper.html#checkSettings-boolean-boolean-"><code>checkSettings(boolean, boolean)</code></a> will print details to <code>System.err</code> before
         throwing the exception. See <a href="../../../soc/server/database/SOCDBHelper.html#PROP_JSETTLERS_DB_SETTINGS"><code>PROP_JSETTLERS_DB_SETTINGS</code></a> to re-run and recover from
         this exception.</dd>
<dd><code>java.sql.SQLException</code> - if an SQL command fails, or the DB couldn't be initialized;
         or if the DB schema version couldn't be detected (if so, exception's
         <code>.getCause()</code> will be an <code>IllegalStateException</code>)</dd>
<dd><code>java.io.IOException</code> - if <tt>props</tt> includes <a href="../../../soc/server/database/SOCDBHelper.html#PROP_JSETTLERS_DB_SCRIPT_SETUP"><code>PROP_JSETTLERS_DB_SCRIPT_SETUP</code></a> but
         the SQL file wasn't found, or if any other IO error occurs reading the script</dd>
</dl>
</li>
</ul>
<a name="isInitialized--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isInitialized</h4>
<pre>public&nbsp;boolean&nbsp;isInitialized()</pre>
<div class="block">Were we able to <a href="../../../soc/server/database/SOCDBHelper.html#initialize-java.lang.String-java.lang.String-java.util.Properties-"><code>initialize(String, String, Properties)</code></a>
 and connect to the database?
 True if db is connected and available; false if never initialized,
 or if <a href="../../../soc/server/database/SOCDBHelper.html#cleanup-boolean-"><code>cleanup(boolean)</code></a> was called.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>True if database available</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.1.14</dd>
</dl>
</li>
</ul>
<a name="getSchemaVersion--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getSchemaVersion</h4>
<pre>public&nbsp;int&nbsp;getSchemaVersion()</pre>
<div class="block">Get the detected schema version of the currently connected database.
 To upgrade an older schema to the latest available, see <a href="../../../soc/server/database/SOCDBHelper.html#upgradeSchema-java.util.Set-"><code>upgradeSchema(Set)</code></a>.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>Schema version, such as <a href="../../../soc/server/database/SOCDBHelper.html#SCHEMA_VERSION_ORIGINAL"><code>SCHEMA_VERSION_ORIGINAL</code></a> or <a href="../../../soc/server/database/SOCDBHelper.html#SCHEMA_VERSION_1200"><code>SCHEMA_VERSION_1200</code></a></dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../soc/server/database/SOCDBHelper.html#SCHEMA_VERSION_LATEST"><code>SCHEMA_VERSION_LATEST</code></a>, 
<a href="../../../soc/server/database/SOCDBHelper.html#isSchemaLatestVersion--"><code>isSchemaLatestVersion()</code></a>, 
<a href="../../../soc/server/database/SOCDBHelper.html#isPasswordLengthOK-java.lang.String-"><code>isPasswordLengthOK(String)</code></a></dd>
</dl>
</li>
</ul>
<a name="isSchemaLatestVersion--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isSchemaLatestVersion</h4>
<pre>public&nbsp;boolean&nbsp;isSchemaLatestVersion()
                              throws java.lang.IllegalStateException</pre>
<div class="block">Does the currently connected DB have the latest schema, with all optional fields?
 (<a href="../../../soc/server/database/SOCDBHelper.html#SCHEMA_VERSION_LATEST"><code>SCHEMA_VERSION_LATEST</code></a>)</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>True if DB schema is the most up-to-date version</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalStateException</code> - if not connected to DB (! <a href="../../../soc/server/database/SOCDBHelper.html#isInitialized--"><code>isInitialized()</code></a>)</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.2.00</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../soc/server/database/SOCDBHelper.html#upgradeSchema-java.util.Set-"><code>upgradeSchema(Set)</code></a>, 
<a href="../../../soc/server/database/SOCDBHelper.html#getSchemaVersion--"><code>getSchemaVersion()</code></a>, 
<a href="../../../soc/server/database/SOCDBHelper.html#doesSchemaUpgradeNeedBGTasks--"><code>doesSchemaUpgradeNeedBGTasks()</code></a></dd>
</dl>
</li>
</ul>
<a name="doesSchemaUpgradeNeedBGTasks--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>doesSchemaUpgradeNeedBGTasks</h4>
<pre>public&nbsp;boolean&nbsp;doesSchemaUpgradeNeedBGTasks()
                                     throws java.lang.IllegalStateException</pre>
<div class="block">For the currently connected DB, are any background tasks needed to complete a recent <a href="../../../soc/server/database/SOCDBHelper.html#upgradeSchema-java.util.Set-"><code>upgradeSchema(Set)</code></a>?
 If so, start those tasks by calling <a href="../../../soc/server/database/SOCDBHelper.html#startSchemaUpgradeBGTasks--"><code>startSchemaUpgradeBGTasks()</code></a>.
<P>
 Background tasks would typically be data conversions to populate new fields, which will gradually activate
 new functionality such as per-user password encoding. The tasks are self-checkpointing and will cleanly resume
 if interrupted by server shutdown.
<P>
 This flag is determined at <a href="../../../soc/server/database/SOCDBHelper.html#initialize-java.lang.String-java.lang.String-java.util.Properties-"><code>initialize(String, String, Properties)</code></a>, by reading the
 <code>db_version</code> table record having <code>max(to_vers)</code>, checking that record for
 a null <code>bg_tasks_done</code> field.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>True if DB schema upgrade needs background tasks</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalStateException</code> - if not connected to DB (! <a href="../../../soc/server/database/SOCDBHelper.html#isInitialized--"><code>isInitialized()</code></a>)</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.2.00</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../soc/server/database/SOCDBHelper.html#isSchemaLatestVersion--"><code>isSchemaLatestVersion()</code></a></dd>
</dl>
</li>
</ul>
<a name="startSchemaUpgradeBGTasks--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>startSchemaUpgradeBGTasks</h4>
<pre>public&nbsp;boolean&nbsp;startSchemaUpgradeBGTasks()</pre>
<div class="block">If not already running, start a thread to do any background tasks needed to complete a
 recent <a href="../../../soc/server/database/SOCDBHelper.html#upgradeSchema-java.util.Set-"><code>upgradeSchema(Set)</code></a>. Thread will start with a 5-second sleep to let other
 SOCServer startup tasks complete.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>true if a thread was started, false if it was already running or ! <a href="../../../soc/server/database/SOCDBHelper.html#isInitialized--"><code>isInitialized()</code></a></dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.2.00</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../soc/server/database/SOCDBHelper.html#doesSchemaUpgradeNeedBGTasks--"><code>doesSchemaUpgradeNeedBGTasks()</code></a></dd>
</dl>
</li>
</ul>
<a name="checkSettings-boolean-boolean-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>checkSettings</h4>
<pre>public final&nbsp;void&nbsp;checkSettings(boolean&nbsp;checkAll,
                                boolean&nbsp;writeIfNeeded)
                         throws java.sql.SQLException,
                                <a href="../../../soc/server/database/DBSettingMismatchException.html" title="class in soc.server.database">DBSettingMismatchException</a></pre>
<div class="block">Check the <code>settings</code> table for optional db-related properties and their fields:
<UL>
 <LI> Set <a href="../../../soc/server/database/SOCDBHelper.html#bcryptWorkFactor"><code>bcryptWorkFactor</code></a> from <code>settings</code>(<a href="../../../soc/server/database/SOCDBHelper.html#SETTING_BCRYPT_WORK__FACTOR"><code>SETTING_BCRYPT_WORK__FACTOR</code></a>)
      unless <a href="../../../soc/server/database/SOCDBHelper.html#props"><code>props</code></a> contains <a href="../../../soc/server/database/SOCDBHelper.html#PROP_JSETTLERS_DB_BCRYPT_WORK__FACTOR"><code>PROP_JSETTLERS_DB_BCRYPT_WORK__FACTOR</code></a>.
</UL>
 If <tt><a href="../../../soc/server/database/SOCDBHelper.html#PROP_JSETTLERS_DB_SETTINGS"><code>PROP_JSETTLERS_DB_SETTINGS</code></a> == "write"</tt> or <code>writeIfNeeded</code>, and any
 settings are missing or have different values in <a href="../../../soc/server/database/SOCDBHelper.html#props"><code>props</code></a>, print differences and update
 the table from properties or default values as needed.
<P>
 Otherwise if any settings are in the table and also in <a href="../../../soc/server/database/SOCDBHelper.html#props"><code>props</code></a> with different values,
 print differences to <code>System.err</code> and throw <a href="../../../soc/server/database/DBSettingMismatchException.html" title="class in soc.server.database"><code>DBSettingMismatchException</code></a>.
<P>
 Called from <a href="../../../soc/server/database/SOCDBHelper.html#initialize-java.lang.String-java.lang.String-java.util.Properties-"><code>initialize(String, String, Properties)</code></a>, after <a href="../../../soc/server/database/SOCDBHelper.html#schemaVersion"><code>schemaVersion</code></a> is determined
 and any settings fields like <a href="../../../soc/server/database/SOCDBHelper.html#bcryptWorkFactor"><code>bcryptWorkFactor</code></a> have been initialized from <a href="../../../soc/server/database/SOCDBHelper.html#props"><code>props</code></a>.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>checkAll</code> - If true check all DB settings against their fields, not only those in <code>props</code>,
     and do not write any updates to the <code>settings</code> table unless <code>writeIfNeeded</code>.</dd>
<dd><code>writeIfNeeded</code> - If true check all DB settings like <code>checkAll</code> and save updates to
     the <code>settings</code> table, as if <tt><a href="../../../soc/server/database/SOCDBHelper.html#PROP_JSETTLERS_DB_SETTINGS"><code>PROP_JSETTLERS_DB_SETTINGS</code></a> == "write"</tt>.
     Set this when running the initial DB setup script.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.sql.SQLException</code> - if any unexpected error occurs</dd>
<dd><code><a href="../../../soc/server/database/DBSettingMismatchException.html" title="class in soc.server.database">DBSettingMismatchException</a></code> - if any value mismatches found in settings table versus props</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.2.00</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../soc/server/database/SOCDBHelper.html#getSettingsFormatted-soc.server.SOCServer-"><code>getSettingsFormatted(SOCServer)</code></a></dd>
</dl>
</li>
</ul>
<a name="getUser-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getUser</h4>
<pre>public&nbsp;java.lang.String&nbsp;getUser(java.lang.String&nbsp;userName)
                         throws java.lang.IllegalArgumentException,
                                java.sql.SQLException</pre>
<div class="block">Search for and return this user (nickname) if it exists in the database.
 If schema &gt;= <a href="../../../soc/server/database/SOCDBHelper.html#SCHEMA_VERSION_1200"><code>SCHEMA_VERSION_1200</code></a>, this check is case-insensitive.
 Returns their nickname as stored in the database.
<P>
 This method replaces <code>doesUserExist(..)</code> used in v1.1.20.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>userName</code> - User nickname to check</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>Nickname if found in users table, <code>null</code> otherwise or if no database is currently connected</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - if <code>userName</code> is <code>null</code></dd>
<dd><code>java.sql.SQLException</code> - if any unexpected database problem</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.2.00</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../soc/server/database/SOCDBHelper.html#authenticateUserPassword-java.lang.String-java.lang.String-soc.server.database.SOCDBHelper.AuthPasswordRunnable-"><code>authenticateUserPassword(String, String, AuthPasswordRunnable)</code></a></dd>
</dl>
</li>
</ul>
<a name="authenticateUserPassword-java.lang.String-java.lang.String-soc.server.database.SOCDBHelper.AuthPasswordRunnable-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>authenticateUserPassword</h4>
<pre>public&nbsp;java.lang.String&nbsp;authenticateUserPassword(java.lang.String&nbsp;sUserName,
                                                 java.lang.String&nbsp;sPassword,
                                                 <a href="../../../soc/server/database/SOCDBHelper.AuthPasswordRunnable.html" title="interface in soc.server.database">SOCDBHelper.AuthPasswordRunnable</a>&nbsp;authCallback)
                                          throws java.sql.SQLException</pre>
<div class="block">Check if this user exists, if so validate their password from the database.
 If schema &gt;= <a href="../../../soc/server/database/SOCDBHelper.html#SCHEMA_VERSION_1200"><code>SCHEMA_VERSION_1200</code></a>, username check is case-insensitive.
 For use of the originally-cased name from that search, if successful this method
 returns their nickname as stored in the database.
<P>
 For running without the optional database, or when user accounts are optional:
 If never connected to a database or user's nickname isn't in the users table,
 and <code>sPassword</code> is "", returns <code>sUserName</code>.
<P>
 This method replaces <code>getUserPassword(..)</code> used before v1.2.00.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>sUserName</code> - Username needing password authentication</dd>
<dd><code>sPassword</code> - Password being tried, or "" if none.
     Different password schemes have different maximum password lengths;
     see <a href="../../../soc/server/database/SOCDBHelper.html#isPasswordLengthOK-java.lang.String-"><code>isPasswordLengthOK(String)</code></a>.
     Passwords longer than 256 characters are always rejected here before checking <code>PW_SCHEME</code>.
     If this user has <a href="../../../soc/server/database/SOCDBHelper.html#PW_SCHEME_NONE"><code>PW_SCHEME_NONE</code></a>, for backwards compatibility <code>sPassword</code> is
     truncated to 20 characters (<a href="../../../soc/server/database/SOCDBHelper.html#PW_MAX_LEN_SCHEME_NONE"><code>PW_MAX_LEN_SCHEME_NONE</code></a>).</dd>
<dd><code>authCallback</code> - Optional callback to make after authentication lookups and hashing succeed or fail.
     This is useful because <a href="../../../soc/server/database/BCrypt.html" title="class in soc.server.database"><code>BCrypt</code></a> password hashing is slow by design, and so is done in another
     thread.  If not <code>null</code>, <code>authCallback</code> is called at the end of this method,
     either in the caller's thread or in a thread dedicated to <code>BCrypt</code> calls.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>user's nickname if password is correct;
     <code>sUserName</code> if password is "" but user doesn't exist in db
     or if database is not currently connected;
     <code>null</code> if account exists in db and password is wrong.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.sql.SQLException</code> - if any unexpected database problem.
     <P>
     Only the <code>BCrypt</code> call will be done in a separate thread; all DB activity happens in this method
     in the caller's thread, so SQLExceptions will be thrown to the caller and not lost or ignored.</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.2.00</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../soc/server/database/SOCDBHelper.html#updateUserPassword-java.lang.String-java.lang.String-"><code>updateUserPassword(String, String)</code></a>, 
<a href="../../../soc/server/database/SOCDBHelper.html#getUser-java.lang.String-"><code>getUser(String)</code></a></dd>
</dl>
</li>
</ul>
<a name="getUserFromHost-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getUserFromHost</h4>
<pre>public&nbsp;java.lang.String&nbsp;getUserFromHost(java.lang.String&nbsp;host)
                                 throws java.sql.SQLException</pre>
<div class="block">DOCUMENT ME!</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>host</code> - DOCUMENT ME!</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>null if user is not authenticated</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.sql.SQLException</code> - DOCUMENT ME!</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../soc/server/database/SOCDBHelper.html#getUser-java.lang.String-"><code>getUser(String)</code></a></dd>
</dl>
</li>
</ul>
<a name="createAccount-java.lang.String-java.lang.String-java.lang.String-java.lang.String-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createAccount</h4>
<pre>public&nbsp;boolean&nbsp;createAccount(java.lang.String&nbsp;userName,
                             java.lang.String&nbsp;host,
                             java.lang.String&nbsp;password,
                             java.lang.String&nbsp;email,
                             long&nbsp;time)
                      throws java.lang.IllegalArgumentException,
                             java.sql.SQLException</pre>
<div class="block">Attempt to create a new account with a unique <code>userName</code> (nickname) in the <code>users</code> table.
 If schema &gt;= <a href="../../../soc/server/database/SOCDBHelper.html#SCHEMA_VERSION_1200"><code>SCHEMA_VERSION_1200</code></a>, the password will be encoded with <a href="../../../soc/server/database/SOCDBHelper.html#PW_SCHEME_BCRYPT"><code>PW_SCHEME_BCRYPT</code></a>.
<P>
 <B>Before calling, validate the user doesn't already exist</B>
 by calling <a href="../../../soc/server/database/SOCDBHelper.html#getUser-java.lang.String-"><code>getUser(userName)</code></a>.
 This method doesn't verify that the user is a unique new user before trying to create the record.
 The DB will throw an exception instead, especially at <a href="../../../soc/server/database/SOCDBHelper.html#SCHEMA_VERSION_1200"><code>SCHEMA_VERSION_1200</code></a> or higher
 which adds a column and unique index for case-insensitive nickname.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>userName</code> - New user name (nickname) to create</dd>
<dd><code>host</code> - Client hostname or IP requesting new account</dd>
<dd><code>password</code> - New user's initial password. Can't be null or "", and must pass
     <a href="../../../soc/server/database/SOCDBHelper.html#isPasswordLengthOK-java.lang.String-"><code>isPasswordLengthOK(String)</code></a> which depends on <a href="../../../soc/server/database/SOCDBHelper.html#getSchemaVersion--"><code>getSchemaVersion()</code></a>.</dd>
<dd><code>email</code> - Optional email address to contact this user</dd>
<dd><code>time</code> - Created-at time, same format as <code>System.currentTimeMillis()</code>
            and <code>Date.Date(long)</code></dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>true if the DB connection is open and the account was created,
     false if no database is currently connected</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - If password is null or too short or too long</dd>
<dd><code>java.sql.SQLException</code> - if any unexpected database problem occurs</dd>
</dl>
</li>
</ul>
<a name="recordLogin-java.lang.String-java.lang.String-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>recordLogin</h4>
<pre>public&nbsp;boolean&nbsp;recordLogin(java.lang.String&nbsp;userName,
                           java.lang.String&nbsp;host,
                           long&nbsp;time)
                    throws java.sql.SQLException</pre>
<div class="block">Record this user's login host and time.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>userName</code> - User name (nickname)</dd>
<dd><code>host</code> - Login is from this client hostname or IP</dd>
<dd><code>time</code> - Login time, same format as <code>System.currentTimeMillis()</code></dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>true if the DB connection is open and the login was recorded, false if connection is closed</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.sql.SQLException</code> - if any unexpected database problem</dd>
</dl>
</li>
</ul>
<a name="updateLastlogin-java.lang.String-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>updateLastlogin</h4>
<pre>public&nbsp;boolean&nbsp;updateLastlogin(java.lang.String&nbsp;userName,
                               long&nbsp;time)
                        throws java.sql.SQLException</pre>
<div class="block">DOCUMENT ME!</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>userName</code> - DOCUMENT ME!</dd>
<dd><code>time</code> - DOCUMENT ME!</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>true if the save succeeded</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.sql.SQLException</code> - if any unexpected database problem</dd>
</dl>
</li>
</ul>
<a name="updateUserPassword-java.lang.String-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>updateUserPassword</h4>
<pre>public&nbsp;boolean&nbsp;updateUserPassword(java.lang.String&nbsp;userName,
                                  java.lang.String&nbsp;newPassword)
                           throws java.lang.IllegalArgumentException,
                                  java.sql.SQLException</pre>
<div class="block">Update a user's password if the user is in the database.
 If schema &gt;= <a href="../../../soc/server/database/SOCDBHelper.html#SCHEMA_VERSION_1200"><code>SCHEMA_VERSION_1200</code></a>, the password will be encoded with <a href="../../../soc/server/database/SOCDBHelper.html#PW_SCHEME_BCRYPT"><code>PW_SCHEME_BCRYPT</code></a>.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>userName</code> - Username to update.  Does not validate this user exists: Call <a href="../../../soc/server/database/SOCDBHelper.html#getUser-java.lang.String-"><code>getUser(String)</code></a>
     first to do so.  If schema &gt;= <a href="../../../soc/server/database/SOCDBHelper.html#SCHEMA_VERSION_1200"><code>SCHEMA_VERSION_1200</code></a>, <code>userName</code> is case-insensitive.</dd>
<dd><code>newPassword</code> - New password. Can't be null or "", and must pass
     <a href="../../../soc/server/database/SOCDBHelper.html#isPasswordLengthOK-java.lang.String-"><code>isPasswordLengthOK(String)</code></a> which depends on <a href="../../../soc/server/database/SOCDBHelper.html#getSchemaVersion--"><code>getSchemaVersion()</code></a>.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>True if the update command succeeded, false if can't connect to db.
     <BR><B>Note:</B> If there is no user with <code>userName</code>, will nonetheless return true.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - If user or password are null, or password is too short or too long</dd>
<dd><code>java.sql.SQLException</code> - if an error occurs</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.1.20</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../soc/server/database/SOCDBHelper.html#authenticateUserPassword-java.lang.String-java.lang.String-soc.server.database.SOCDBHelper.AuthPasswordRunnable-"><code>authenticateUserPassword(String, String, AuthPasswordRunnable)</code></a></dd>
</dl>
</li>
</ul>
<a name="getMaxPasswordLength--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getMaxPasswordLength</h4>
<pre>public final&nbsp;int&nbsp;getMaxPasswordLength()</pre>
<div class="block">Get the maximum password length, given the current schema version's encoding scheme
 (<a href="../../../soc/server/database/SOCDBHelper.html#PW_SCHEME_BCRYPT"><code>PW_SCHEME_BCRYPT</code></a> or <a href="../../../soc/server/database/SOCDBHelper.html#PW_SCHEME_NONE"><code>PW_SCHEME_NONE</code></a>).
 To check a specific password's length, call <a href="../../../soc/server/database/SOCDBHelper.html#isPasswordLengthOK-java.lang.String-"><code>isPasswordLengthOK(String)</code></a> instead.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>Maximum allowed password length for current password scheme
     (<a href="../../../soc/server/database/SOCDBHelper.html#PW_MAX_LEN_SCHEME_BCRYPT"><code>PW_MAX_LEN_SCHEME_BCRYPT</code></a> or <a href="../../../soc/server/database/SOCDBHelper.html#PW_MAX_LEN_SCHEME_NONE"><code>PW_MAX_LEN_SCHEME_NONE</code></a>)</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.2.00</dd>
</dl>
</li>
</ul>
<a name="isPasswordLengthOK-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isPasswordLengthOK</h4>
<pre>public final&nbsp;boolean&nbsp;isPasswordLengthOK(java.lang.String&nbsp;password)</pre>
<div class="block">Is this password's nonzero length less than or equal to the current maximum, given the current schema version's
 password encoding scheme (<a href="../../../soc/server/database/SOCDBHelper.html#PW_SCHEME_BCRYPT"><code>PW_SCHEME_BCRYPT</code></a> or <a href="../../../soc/server/database/SOCDBHelper.html#PW_SCHEME_NONE"><code>PW_SCHEME_NONE</code></a>)?
 For <a href="../../../soc/server/database/SOCDBHelper.html#PW_SCHEME_BCRYPT"><code>PW_SCHEME_BCRYPT</code></a>, checks length of its <code>UTF-8</code> bytes.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>password</code> - Password being tried</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>True if password isn't null or "", and isn't longer than the current maximum</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.2.00</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../soc/server/database/SOCDBHelper.html#getMaxPasswordLength--"><code>getMaxPasswordLength()</code></a></dd>
</dl>
</li>
</ul>
<a name="saveGameScores-soc.game.SOCGame-int-boolean-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>saveGameScores</h4>
<pre>public&nbsp;boolean&nbsp;saveGameScores(<a href="../../../soc/game/SOCGame.html" title="class in soc.game">SOCGame</a>&nbsp;ga,
                              int&nbsp;gameLengthSeconds,
                              boolean&nbsp;winLossOnly)
                       throws java.lang.IllegalArgumentException,
                              java.sql.SQLException</pre>
<div class="block">Record this completed game's time, players, scores, and game options in the database.
 For players whose users exist in the database, update their win-loss counts.
<P>
 User win-loss records require schema version &gt;= <a href="../../../soc/server/database/SOCDBHelper.html#SCHEMA_VERSION_2000"><code>SCHEMA_VERSION_2000</code></a>.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>ga</code> - Game that's just completed</dd>
<dd><code>gameLengthSeconds</code> - Duration of game, from <a href="../../../soc/game/SOCGame.html#getDurationSeconds--"><code>SOCGame.getDurationSeconds()</code></a></dd>
<dd><code>winLossOnly</code> - If true don't store game details, only update users' win-loss counts.
     Caller should negate value of <a href="../../../soc/server/database/SOCDBHelper.html#PROP_JSETTLERS_DB_SAVE_GAMES"><code>PROP_JSETTLERS_DB_SAVE_GAMES</code></a> to set this parameter.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>true if the save succeeded</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - if <a href="../../../soc/game/SOCGame.html#getPlayerWithWin--"><code>ga.getPlayerWithWin()</code></a> is null</dd>
<dd><code>java.sql.SQLException</code> - if an error occurs</dd>
</dl>
</li>
</ul>
<a name="retrieveRobotParams-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>retrieveRobotParams</h4>
<pre>public final&nbsp;<a href="../../../soc/util/SOCRobotParameters.html" title="class in soc.util">SOCRobotParameters</a>&nbsp;retrieveRobotParams(java.lang.String&nbsp;robotName)
                                             throws java.sql.SQLException</pre>
<div class="block">Get this robot's specialized parameters from the database, if it has an entry there.
 If you need default params if bot not found or no database,
 call <a href="../../../soc/server/SOCServer.html#getRobotParameters-java.lang.String-"><code>SOCServer.getRobotParameters(String)</code></a> instead.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>robotName</code> - Name of robot for db lookup</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>null if robotName not in database, or if db is empty and robotparams table doesn't exist</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.sql.SQLException</code> - if unexpected problem retrieving the params</dd>
</dl>
</li>
</ul>
<a name="countUsers--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>countUsers</h4>
<pre>public&nbsp;int&nbsp;countUsers()
               throws java.sql.SQLException</pre>
<div class="block">Count the number of users, if any, currently in the users table.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>User count, or -1 if not connected.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.sql.SQLException</code> - if unexpected problem counting the users</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.1.19</dd>
</dl>
</li>
</ul>
<a name="getSettingsFormatted-soc.server.SOCServer-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getSettingsFormatted</h4>
<pre>public&nbsp;java.util.List&lt;java.lang.String&gt;&nbsp;getSettingsFormatted(<a href="../../../soc/server/SOCServer.html" title="class in soc.server">SOCServer</a>&nbsp;srv)</pre>
<div class="block">Build a list of DB settings and related info like <a href="../../../soc/server/database/SOCDBHelper.html#getSchemaVersion--"><code>getSchemaVersion()</code></a> and the BCrypt work factor,
 formatted for printing for an admin user: friendly names and values, not technical name keys.
 Includes all known settings, such as <a href="../../../soc/server/database/SOCDBHelper.html#SETTING_BCRYPT_WORK__FACTOR"><code>SETTING_BCRYPT_WORK__FACTOR</code></a>.
 Also includes JDBC version, <code>DatabaseMetaData.supportsGetGeneratedKeys()</code>, etc.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>srv</code> - Server, solely to call <a href="../../../soc/server/genericServer/Server.html#getConfigBoolProperty-java.lang.String-boolean-"><code>Server.getConfigBoolProperty(String, boolean)</code></a></dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>Formatted list of DB settings. Always an even number of items, a name and then a value
     for each setting. Some values might be <code>null</code>.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalStateException</code> - if not connected to DB (! <a href="../../../soc/server/database/SOCDBHelper.html#isInitialized--"><code>isInitialized()</code></a>)</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.2.00</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../soc/server/database/SOCDBHelper.html#checkSettings-boolean-boolean-"><code>checkSettings(boolean, boolean)</code></a></dd>
</dl>
</li>
</ul>
<a name="queryUsersDuplicateLCase-java.util.Set-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>queryUsersDuplicateLCase</h4>
<pre>public&nbsp;java.util.Map&lt;java.lang.String,java.util.List&lt;java.lang.String&gt;&gt;&nbsp;queryUsersDuplicateLCase(java.util.Set&lt;java.lang.String&gt;&nbsp;out_allNames)
                                                                                          throws java.lang.IllegalStateException,
                                                                                                 java.sql.SQLException</pre>
<div class="block">Query all users to find any 'duplicate' user names, according to
 <code>String.toLowercase</code>
 (<code>Locale.US</code>).
 Return any if found.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>out_allNames</code> - if not <code>null</code>, will place all usernames in the database into this set</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd><code>null</code> if no dupes, or a Map of any lowercased names
     to all the non-lowercased names which all map to that lowercased name</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalStateException</code></dd>
<dd><code>java.sql.SQLException</code></dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.2.00</dd>
</dl>
</li>
</ul>
<a name="testBCryptSpeed--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>testBCryptSpeed</h4>
<pre>public&nbsp;int&nbsp;testBCryptSpeed()</pre>
<div class="block">Run timing tests for <a href="../../../soc/server/database/BCrypt.html" title="class in soc.server.database"><code>BCrypt</code></a> at various work factors, and print results to <code>System.err</code>.
 Look for an acceptable speed of about 270-620 milliseconds per BCrypt.
 Starting range is <a href="../../../soc/server/database/SOCDBHelper.html#BCRYPT_DEFAULT_WORK_FACTOR"><code>BCRYPT_DEFAULT_WORK_FACTOR</code></a> +/- 3. If all those work factors are
 too fast, the range is gradually increased up to <a href="../../../soc/server/database/BCrypt.html#GENSALT_MAX_LOG2_ROUNDS"><code>BCrypt.GENSALT_MAX_LOG2_ROUNDS</code></a>
 until an acceptable WF is found.
<P>
 Called from <code>SOCServer</code> startup (Utility Mode) when
 <a href="../../../soc/server/database/SOCDBHelper.html#PROP_JSETTLERS_DB_BCRYPT_WORK__FACTOR"><code>PROP_JSETTLERS_DB_BCRYPT_WORK__FACTOR</code></a> is <code>"test"</code>.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The fastest acceptable work factor (270-620 milliseconds per BCrypt),
     or -1 if all tested WFs were too slow, or -2 if all WFs were too fast</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.2.00</dd>
</dl>
</li>
</ul>
<a name="selectWithLimit-java.lang.String-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>selectWithLimit</h4>
<pre>public&nbsp;java.sql.ResultSet&nbsp;selectWithLimit(java.lang.String&nbsp;selectStmt,
                                          int&nbsp;limit)
                                   throws java.sql.SQLException</pre>
<div class="block">Build and run a SELECT query, with a LIMIT clause appropriate to the DB type if possible.
 Currently possible for MariaDB, MySQL, Postgres, SQLite, and semi-supported ORA.
 Otherwise this will be a standard SELECT without any LIMIT clause.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>selectStmt</code> - SQL statement, beginning with SELECT, omitting trailing <code>';'</code>.
     <BR>
     Example: <code>"SELECT * FROM games WHERE duration_sec &gt;= 3600"</code></dd>
<dd><code>limit</code> - Number of rows for LIMIT clause</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>This limited SELECT statement's ResultSet, from <code>Statement.executeQuery(String)</code></dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.sql.SQLException</code> - if any unexpected database problem</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.2.00</dd>
</dl>
</li>
</ul>
<a name="doesTableExist-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>doesTableExist</h4>
<pre>public&nbsp;boolean&nbsp;doesTableExist(java.lang.String&nbsp;tabname)
                       throws java.lang.IllegalStateException</pre>
<div class="block">Query to see if a table exists in the database.
 Any exception is caught here and returns false.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>tabname</code> - Table name to check for; case-sensitive in some db types.
    The jsettlers standard is to always use lowercase names when creating tables and columns.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>true if table exists in the current connection's database</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalStateException</code> - If not connected and if <a href="../../../soc/server/database/SOCDBHelper.html#checkConnection--"><code>checkConnection()</code></a> fails</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.2.00</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../soc/server/database/SOCDBHelper.html#doesTableColumnExist-java.lang.String-java.lang.String-"><code>doesTableColumnExist(String, String)</code></a></dd>
</dl>
</li>
</ul>
<a name="doesTableColumnExist-java.lang.String-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>doesTableColumnExist</h4>
<pre>public&nbsp;boolean&nbsp;doesTableColumnExist(java.lang.String&nbsp;tabname,
                                    java.lang.String&nbsp;colname)
                             throws java.lang.IllegalStateException</pre>
<div class="block">Query to see if a column exists in a table.
 Any exception is caught here and returns false.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>tabname</code> - Table name to check <tt>colname</tt> within; case-sensitive in some db types</dd>
<dd><code>colname</code> - Column name to check; case-sensitive in some db types.
    The jsettlers standard is to always use lowercase names when creating tables and columns.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>true if column exists in the current connection's database</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalStateException</code> - If not connected and if <a href="../../../soc/server/database/SOCDBHelper.html#checkConnection--"><code>checkConnection()</code></a> fails</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.1.14</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../soc/server/database/SOCDBHelper.html#doesTableExist-java.lang.String-"><code>doesTableExist(String)</code></a></dd>
</dl>
</li>
</ul>
<a name="upgradeSchema-java.util.Set-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>upgradeSchema</h4>
<pre>public&nbsp;void&nbsp;upgradeSchema(java.util.Set&lt;java.lang.String&gt;&nbsp;userAdmins)
                   throws java.lang.IllegalStateException,
                          java.sql.SQLException,
                          java.util.MissingResourceException</pre>
<div class="block">Perform pre-checks and upgrade the currently connected DB to the latest schema, with all optional fields.
 After this method returns, call <a href="../../../soc/server/database/SOCDBHelper.html#doesSchemaUpgradeNeedBGTasks--"><code>doesSchemaUpgradeNeedBGTasks()</code></a> to determine if the upgrade needs
 further tasks or conversions in a background thread. See that method's javadoc for how to start the thread.
<P>
 Pre-checks include <a href="../../../soc/server/database/SOCDBHelper.html#queryUsersDuplicateLCase-java.util.Set-"><code>queryUsersDuplicateLCase(Set)</code></a>.
 If upgrading from <a href="../../../soc/server/database/SOCDBHelper.html#SCHEMA_VERSION_ORIGINAL"><code>SCHEMA_VERSION_ORIGINAL</code></a> and <a href="../../../soc/server/database/SOCDBHelper.html#PROP_JSETTLERS_DB_BCRYPT_WORK__FACTOR"><code>PROP_JSETTLERS_DB_BCRYPT_WORK__FACTOR</code></a>
 is not set, pre-check calls <a href="../../../soc/server/database/SOCDBHelper.html#testBCryptSpeed--"><code>testBCryptSpeed()</code></a> to set the Work Factor.

<H3>Security note:</H3>
 To upgrade the schema, the DB connect username must have authorization grants to
 run DDL commands, add or alter tables, etc.

<H3>Rollback of failed upgrade:</H3>
 If the schema upgrade fails, errors will be printed to <code>System.err</code> and thrown as a SQLException.
 If failures also occur during rollback, those are also printed to <code>System.err</code>.
 If the DB is SQLite, any added table fields can't be dropped, and the DB file must be restored from a backup
 because rollback is incomplete.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>userAdmins</code> - List of users who are user admins, for special treatment during upgrade if needed,
     or <code>null</code>. These user nicknames do not need to actually exist in the database.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalStateException</code> - if already latest version (<a href="../../../soc/server/database/SOCDBHelper.html#isSchemaLatestVersion--"><code>isSchemaLatestVersion()</code></a>),
     or if not connected to DB (! <a href="../../../soc/server/database/SOCDBHelper.html#isInitialized--"><code>isInitialized()</code></a>)</dd>
<dd><code>java.util.MissingResourceException</code> - if pre-checks indicate a problem in the data (such as wrong current DB user,
     or nicknames which collide with each other when lowercase) which must be manually resolved by this
     server's administrator before upgrade: <code>Throwable.getMessage()</code> will be a multi-line string with
     problem details to show to the server admin.
    <P>
     Upgrade to schema 2.0.00 for <code>DBTYPE_ORA</code> isn't yet implemented: Upgrade attempts
     on that DB type will throw <code>MissingResourceException</code>.</dd>
<dd><code>java.sql.SQLException</code> - if any unexpected database problem during the upgrade</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.2.00</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><code>#isSchemaLatestVersion()}</code></dd>
</dl>
</li>
</ul>
<a name="cleanup-boolean-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>cleanup</h4>
<pre>public&nbsp;void&nbsp;cleanup(boolean&nbsp;isForShutdown)</pre>
<div class="block">Close out and shut down the database connection.
 Any <code>SQLException</code>s while doing so are caught here.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>isForShutdown</code> - If true, set <tt>connection = null</tt>
          so we won't try to reconnect later.</dd>
</dl>
</li>
</ul>
<a name="dispResultSet-java.sql.ResultSet-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>dispResultSet</h4>
<pre>static&nbsp;void&nbsp;dispResultSet(java.sql.ResultSet&nbsp;rs)
                   throws java.sql.SQLException</pre>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.sql.SQLException</code></dd>
</dl>
</li>
</ul>
<a name="testDBHelper--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>testDBHelper</h4>
<pre>public final&nbsp;void&nbsp;testDBHelper()
                        throws java.lang.IllegalStateException,
                               java.sql.SQLException</pre>
<div class="block">Tests for a working database connection, unit tests for <a href="../../../soc/server/database/SOCDBHelper.html" title="class in soc.server.database"><code>SOCDBHelper</code></a> methods.
 Prints success or failure to <code>System.err</code>.
<P>
 To run these tests, DB connection info must be initialized and the DB schema should
 contain what's in <code>jsettlers-tables.sql</code>: <code>games</code>, etc.
 The current DB user must have been granted ability to create and drop new tables,
 but does not need to be the owner of the currently existing tables. That is, tests
 can run as the <code>socuser</code> user and not <code>postgres</code> or mysql <code>root</code> user.
<P>
 Called from <a href="../../../soc/server/SOCServer.html#initSocServer-java.lang.String-java.lang.String-"><code>SOCServer.initSocServer(String, String)</code></a>
 if <a href="../../../soc/server/SOCServer.html#PROP_JSETTLERS_TEST_DB"><code>SOCServer.PROP_JSETTLERS_TEST_DB</code></a> flag is set.
<P>
 <B>Security note:</B> To run some tests, the DB connect username must be granted authorization to
 run DDL commands, add or alter tables, etc.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalStateException</code> - if <a href="../../../soc/server/database/SOCDBHelper.html#initialize-java.lang.String-java.lang.String-java.util.Properties-"><code>initialize(String, String, Properties)</code></a> hasn't yet been called,
     or if DB has no tables. To avoid throwing this, don't call this method if ! <a href="../../../soc/server/database/SOCDBHelper.html#isInitialized--"><code>isInitialized()</code></a>.</dd>
<dd><code>java.sql.SQLException</code> - if connection fails or any required tests failed</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>2.0.00</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../soc/server/database/DBSettingMismatchException.html" title="class in soc.server.database"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../soc/server/database/SOCDBHelper.AuthPasswordRunnable.html" title="interface in soc.server.database"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?soc/server/database/SOCDBHelper.html" target="_top">Frames</a></li>
<li><a href="SOCDBHelper.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
